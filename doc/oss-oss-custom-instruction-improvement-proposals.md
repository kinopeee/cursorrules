# カスタムインストラクションOSS公開リポジトリ 改善提案

## 1. 背景と目的

このリポジトリは、Cursor 用カスタムインストラクション（`.cursor/rules/*.mdc`）とワークフロー（`.cursor/commands/*.md`）を OSS として公開し、他プロジェクトでも再利用しやすくすることを目的としています。一方で、利用者が「どこをどう調整すれば自分のプロジェクトに合わせられるか」を素早く理解するには、現状ドキュメントだけではやや情報が分散している側面があります。

本ドキュメントでは、OSS 利用者（他リポジトリの開発者）がスムーズに導入・カスタマイズできるようにするための改善案を整理します。

## 2. 現状整理（2025-11 時点）

- `README.md` / `README.en.md` で、リポジトリ全体の概要と導入手順の大枠は説明済み。
- `doc/rules-and-workflows.md` において、ルール（Rules）とワークフロー（Workflows）の役割分担とベストプラクティスが整理されている。
- `.cursor/rules` 配下に、以下の代表的なルールファイルが提供されている。
  - `v5.mdc` / `v5.en.mdc`: コーディング基盤ルール
  - `test-strategy.mdc` / `test-strategy.en.mdc`: テスト戦略ルール
  - `commit-message-format.mdc` / `commit-message-format.en.mdc`: コミットメッセージ規約
  - `pr-message-format.mdc` / `pr-message-format.en.mdc`: PR メッセージ規約
- ルールとワークフローの関係性（参照関係）は、Mermaid 図で視覚的に説明されている。

### 課題感（高レベル）

- OSS 利用者が「自分のリポジトリへの適用フロー」や「どこをカスタマイズすべきか」を、一枚のドキュメントだけでは把握しづらい。
- ルールファイルそのものはよく設計されているが、
  - どの値が「プロジェクト固有」として書き換え前提なのか
  - どの部分は可能ならそのまま再利用してほしいのか
  が、初見だとやや分かりにくい。
- GPT-5.1 世代の開発フロー（例: no-reasoning モード・適応的推論・ツールの並列実行など）との結びつきを、OSS 利用者向けにもう一段だけ具体化できる余地がある。

## 3. 改善案一覧

### 3-1. OSS 利用者向け「はじめに」ガイドの追加

**提案**: OSS 利用者が最初に読むことを想定した、導入専用ガイド（例: `doc/oss-getting-started.md`）を追加する。

- 想定読者
  - Cursor を既に利用しており、自分のリポジトリに `.cursor/rules` / `.cursor/commands` を導入したい人。
- 記載内容のイメージ
  - このリポジトリの役割と、同梱されているルール／ワークフローの一覧。
  - 最小構成で「まず何をコピーすればよいか」のステップバイステップ：
    1. `v5.mdc` / `v5.en.mdc` のどちらかを、自分のリポジトリの `.cursor/rules` にコピーする。
    2. テスト戦略や commit/PR 規約が必要であれば、対応する `.mdc` を追加でコピーする。
    3. `.cursor/commands` 配下のワークフローから、よく使うもの（`commit-only` など）だけを選んで導入する。
  - 「README ではリポジトリの背景と設計思想、oss-getting-started では導入の具体手順」という役割分担を明示する。

### 3-2. 「カスタマイズポイント」明示用セクション／コメントの追加

**提案**: ルールファイルにおいて「プロジェクトごとにカスタマイズすべき項目」を、より明示的に示す。

- 例
  - `commit-message-format.mdc` / `pr-message-format.mdc` での `language` や Prefix 一覧について、
    - `// カスタマイズ推奨: プロジェクトの運用言語に合わせて変更してください` のようなコメントを追加する。
  - `test-strategy.mdc` では、カバレッジ目標値や外部依存の扱いについて、
    - 「組織の QA 方針に応じて緩和／強化することを想定」などの一文を追加し、変更をためらわないようにする。
- 効果
  - 初見の利用者でも、「この値は必須のガードレール」「この値はチューニングポイント」といった区別がつきやすくなる。

### 3-3. GPT-5.1 最適化の具体例とレシピ集

**提案**: GPT-5.1 の公式ガイド（適応的推論、no-reasoning モード、プロンプトキャッシュなど）を踏まえた「レシピ集」ドキュメントを追加する。

- 例: `doc/gpt51-recipes.md`
  - 軽量タスクでは no-reasoning を優先し、応答を 1〜2 文に抑えるための User Rule 例。
  - 標準／重要タスクで、チェックリスト＋ツール並列化をフル活用するためのプロンプト例。
  - `v5` と組み合わせた「テスト戦略タスク用」プロンプトテンプレート（テスト観点表→実装→カバレッジ確認という流れを自動化する）。
- 効果
  - 単なるルールの配布に留まらず、「どのように使えば GPT-5.1 の特性を最大限活かせるか」が共有できる。

### 3-4. ルール／ワークフロー別の変更履歴（CHANGELOG セクション分割）

**提案**: 既存の `CHANGELOG.md` / `CHANGELOG.en.md` を、「ルール」「ワークフロー」「翻訳ガイド」などのカテゴリごとにサブセクション分割する。

- 例
  - `## Rules`
    - `v5` の変更
    - `test-strategy` の変更
  - `## Workflows`
    - `commit-only` / `commit-push` / `commit-push-pr` の変更
  - `## Docs`
    - `rules-and-workflows.md` や翻訳ガイドの変更
- 効果
  - OSS 利用者が「どのファイル群に breaking 変更が入ったのか」を素早く確認できる。
  - ルールファイルのみをアップデートしたい場合などに、影響範囲が把握しやすくなる。

### 3-5. 代表的な利用シナリオ別セットアップガイド

**提案**: 代表的な利用パターン（シナリオ）ごとに「この組み合わせで入れるとよい」という推奨セットを提示する。

- 例: `doc/usage-scenarios.md`
  - **シナリオA: 小規模 OSS プロジェクトで最低限のガードレールだけ入れたい**
    - 必須: `v5.mdc`
    - 任意: `commit-message-format.mdc`
  - **シナリオB: 商用サービス開発でテスト戦略・PR ルールも厳しめに適用したい**
    - 必須: `v5.mdc` + `test-strategy.mdc` + `commit-message-format.mdc` + `pr-message-format.mdc`
  - **シナリオC: 英語圏チームで運用したい**
    - `.en.mdc` 系を中心に利用しつつ、プロジェクト固有の Prefix や QA 方針のみを差し替える手順を記載。
- 効果
  - 利用者は、自分のユースケースと近いシナリオを選ぶだけで、初期セットアップの迷いを減らせる。

### 3-6. 貢献ガイド（CONTRIBUTING）とイシュー／PR テンプレート

**提案**: 外部コントリビューションを受け入れやすくするため、以下を追加する。

- `CONTRIBUTING.md`
  - ルールファイルの変更ポリシー（Breaking change の扱いなど）。
  - 新しいルール／ワークフロー追加時のガイドライン（命名規則、言語ポリシー、テスト方針）。
  - PR に必須のチェック項目（ルールとの整合性確認、サンプルコマンドのテストなど）。
- `.github/ISSUE_TEMPLATE` / `.github/PULL_REQUEST_TEMPLATE`
  - ルール改善提案用テンプレート（背景・問題・提案・代替案など）。
  - 変更対象がどのカテゴリ（Rules / Workflows / Docs）かを明示するチェックボックス。

### 3-7. ローカルテスト／検証フローの明文化

**提案**: このリポジトリ自体を変更する際の「想定テストフロー」を、簡易的でよいのでドキュメント化する。

- 例: `doc/dev-workflow.md`
  - ルールファイルを変更した場合の最低限のセルフチェック項目：
    - フォーマット（YAML/JSON ライクな構造）の整合性確認。
    - 既存プロンプトとの競合確認（User Rules や Memories との整合性）。
  - ワークフローコマンドを変更した場合のチェック項目：
    - ローカルで `git` コマンドが正しく動作するか。
    - ブランチ名やリモート名がハードコードされていないか。

### 3-8. 翻訳・多言語運用のベストプラクティス拡充

**提案**: 既存の `TRANSLATION_GUIDE.md` を補完する形で、「複数言語版のルールを運用する際の注意点」を追加する。

- 例
  - `language` が `ja` / `en` の両方で `alwaysApply: true` になっている場合の衝突リスクと、その回避策。
  - 実運用で「どちらか一方のみを常時有効にし、もう一方はサンプルとして残す」パターンの紹介。
  - 翻訳時に意味が変わりやすい用語のリストアップ（例: "test coverage" vs "statement coverage" など）。

## 4. 優先度と実装コストの目安

| 改善案 ID | 内容                                          | 期待インパクト | 実装コスト(目安) |
|-----------|-----------------------------------------------|----------------|------------------|
| P1        | OSS 向け「はじめに」ガイド追加               | 高             | 低〜中           |
| P2        | ルール内カスタマイズポイントの明示           | 中〜高         | 低               |
| P3        | GPT-5.1 レシピ集                              | 中             | 中               |
| P4        | CHANGELOG のカテゴリ分割                      | 中             | 低               |
| P5        | 利用シナリオ別セットアップガイド              | 中〜高         | 中               |
| P6        | CONTRIBUTING & Issue/PR テンプレート追加      | 中             | 中               |
| P7        | 開発者向け dev ワークフローの明文化           | 中             | 低〜中           |
| P8        | 翻訳・多言語運用ベストプラクティス拡充       | 中             | 低〜中           |

初期フェーズでは P1, P2, P4 あたりから着手し、その後 P5, P6, P7, P8 を順次追加すると、OSS 利用者の体験向上とコントリビューションしやすさの両方をバランスよく改善できます。

## 5. 今後の進め方（例）

1. **ブランチ戦略の決定**
   - 例: `feature/oss-doc-improvements` のようなブランチを切り、このドキュメントで列挙した改善案を小さめの PR に分割して実装する。
2. **ドキュメント系改善から着手**
   - `oss-getting-started` / `usage-scenarios` など、既存ルールに手を入れない範囲から始めると、リスクが低い。
3. **ルールファイルへの軽微なコメント追加**
   - カスタマイズポイントのコメントなど、挙動を変えない変更から導入する。
4. **ユーザーフィードバックの収集**
   - 実際に他プロジェクトで利用しているユーザーから、「どこでつまずいたか」「どのドキュメントが役立ったか」を収集し、本ドキュメントの改善案を更新していく。

---

※ このファイルは、カスタムインストラクションを OSS として公開する際の改善アイデアをまとめたものであり、実際の変更内容や優先度は、プロジェクトの運用方針やユーザーからのフィードバックに応じて調整してください。